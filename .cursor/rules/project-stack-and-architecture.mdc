---
alwaysApply: true
---

# Cursor Rules - React + TypeScript + CSS Modules + ITCSS + BEM

## Functional Requirements & Specs

- The full functional specification lives in `docs/functional-requirements.md`.
- When creating or modifying pages, components, routes, or copy:
  - **Follow the behaviors and flows defined in that file**.
  - **Do not invent new features, pages, or states** that are not in the spec or Figma.
- If an instruction in a prompt conflicts with `docs/functional-requirements.md`, **prefer the functional requirements file**.

## Tech Stack

- React 18+ (Functional components only)
- TypeScript (strict mode)
- Vite
- CSS Modules + CSS Variables
- Simplified ITCSS Architecture
- BEM Naming Convention

## File Structure

```
src/
  styles/
    settings/
      variables.css          # CSS variables
    generic/
      reset.css             # CSS reset/normalize
    elements/
      base.css              # Base element styles
    global.css              # Imports all layers
  components/ComponentName/
    ComponentName.tsx
    ComponentName.module.css
    ComponentName.constants.ts
    index.ts
  pages/PageName/
    PageName.tsx
    PageName.module.css
```

## ITCSS Layer Structure

### 1. Settings Layer (CSS Variables)

```css
/* styles/settings/variables.css */
:root {
  /* Colors */
  --color-primary: #18181b;
  --color-secondary: #71717a;
  --color-white: #ffffff;
  --color-black: #000000;
  --color-gray-50: #fafafa;
  --color-gray-100: #f4f4f5;
  --color-gray-200: #e4e4e7;
  --color-error: #ef4444;
  --color-success: #22c55e;

  /* Spacing */
  --space-xs: 0.25rem;
  --space-sm: 0.5rem;
  --space-md: 1rem;
  --space-lg: 1.5rem;
  --space-xl: 2rem;
  --space-2xl: 3rem;

  /* Typography */
  --font-size-xs: 0.75rem;
  --font-size-sm: 0.875rem;
  --font-size-base: 1rem;
  --font-size-lg: 1.125rem;
  --font-size-xl: 1.25rem;
  --font-size-2xl: 1.5rem;
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-bold: 700;

  /* Layout */
  --border-radius-sm: 0.25rem;
  --border-radius-md: 0.5rem;
  --border-radius-lg: 1rem;
  --border-radius-full: 9999px;

  /* Transitions */
  --transition-fast: 150ms ease;
  --transition-base: 200ms ease;
  --transition-slow: 300ms ease;

  /* Z-index */
  --z-dropdown: 100;
  --z-modal: 200;
  --z-tooltip: 300;
}
```

### 2. Generic Layer

```css
/* styles/generic/reset.css */
*,
*::before,
*::after {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  font-size: 16px;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

body {
  line-height: 1.5;
}

img,
picture,
video,
canvas,
svg {
  display: block;
  max-width: 100%;
}

button {
  font: inherit;
  background: none;
  border: none;
  cursor: pointer;
}
```

### 3. Elements Layer

```css
/* styles/elements/base.css */
body {
  font-family: system-ui, -apple-system, sans-serif;
  font-size: var(--font-size-base);
  color: var(--color-primary);
  background-color: var(--color-gray-50);
}

h1,
h2,
h3,
h4,
h5,
h6 {
  font-weight: var(--font-weight-bold);
  line-height: 1.2;
}

a {
  color: var(--color-primary);
  text-decoration: none;
}

input,
textarea,
select {
  font: inherit;
  color: inherit;
}
```

### 4. Global CSS (Import All)

```css
/* styles/global.css */
@import "./settings/variables.css";
@import "./generic/reset.css";
@import "./elements/base.css";
```

## BEM Naming Convention

### BEM Structure

- **Block**: Independent component (`.button`)
- **Element**: Part of block (`.button__icon`)
- **Modifier**: Intent/state (`.button--primary`, `.button--disabled`)

### BEM in CSS Modules

```css
/* Button.module.css */

/* Block */
.button {
  display: flex;
  align-items: center;
}

/* Elements */
.button__icon {
  margin-right: var(--space-sm);
}

.button__text {
  font-size: var(--font-size-base);
}

/* Modifiers - Intents */
.button--primary {
  background-color: var(--color-primary);
  color: var(--color-white);
}

.button--secondary {
  background-color: transparent;
  border: 1px solid var(--color-gray-200);
}

/* Modifiers - States */
.button--disabled {
  opacity: 0.5;
  pointer-events: none;
}

.button--loading {
  cursor: wait;
}

/* Modifiers - Sizes */
.button--small {
  padding: var(--space-sm) var(--space-md);
  font-size: var(--font-size-sm);
}

.button--large {
  padding: var(--space-lg) var(--space-xl);
  font-size: var(--font-size-lg);
}
```

## Component Pattern

```typescript
import { useState } from "react";
import { INTENT, SIZE } from "./Button.constants";
import styles from "./Button.module.css";

interface IButton extends React.ButtonHTMLAttributes<HTMLButtonElement> {
  intent?: IntentType;
  size?: SizeType;
  disabled?: boolean;
  loading?: boolean;
  icon?: React.ReactNode;
  children?: React.ReactNode;
}

function Button({
  intent = INTENT.PRIMARY,
  size = SIZE.MEDIUM,
  disabled = false,
  loading = false,
  icon,
  children,
  className = "",
  ...props
}: IButton) {
  const handleClick = () => onClick?.();

  // BEM class composition
  const buttonClasses = [
    styles.button, // Block
    styles[`button--${intent}`], // Intent modifier
    styles[`button--${size}`], // Size modifier
    disabled && styles["button--disabled"], // State modifier
    loading && styles["button--loading"], // State modifier
    className,
  ]
    .filter(Boolean)
    .join(" ");

  return (
    <button className={buttonClasses} disabled={disabled} {...props}>
      {icon && <span className={styles.button__icon}>{icon}</span>}
      {children && <span className={styles.button__text}>{children}</span>}
    </button>
  );
}

export { Button };
```

## Constants Pattern

```typescript
// Component.constants.ts
export const INTENT = {
  PRIMARY: "primary",
  SECONDARY: "secondary",
  SUCCESS: "success",
  ERROR: "error",
  WARNING: "warning",
} as const;

export const SIZE = {
  SMALL: "small",
  MEDIUM: "medium",
  LARGE: "large",
} as const;
```

## Naming Conventions

- **Components/Files**: `PascalCase.tsx`
- **CSS Modules**: `ComponentName.module.css`
- **CSS Classes (BEM)**: `kebab-case` (`.button`, `.button__icon`, `.button--primary`)
- **CSS Variables**: `--kebab-case`
- **Interfaces**: `IComponentName`
- **Types**: `ComponentType` (use `IntentType` instead of `VariantType`)
- **Constants**: `UPPER_SNAKE_CASE` (use `INTENT` instead of `VARIANT`)
- **Functions/Variables**: `camelCase`

## BEM Usage Guidelines

### When to Use BEM

✅ **Use BEM for:**

- Component with internal elements (`.card`, `.card__header`, `.card__body`)
- Component with multiple intents (`.button--primary`, `.button--secondary`)
- Component with states (`.input--error`, `.input--disabled`)
- Complex components with nested structure

### When NOT to Use BEM

❌ **Skip BEM for:**

- Single-element components with no children
- Simple wrappers
- Utility classes (use simple class names)

### BEM Examples

#### Card Component

```css
/* Card.module.css */
.card {
  border-radius: var(--border-radius-md);
  background: var(--color-white);
}

.card__header {
  padding: var(--space-lg);
  border-bottom: 1px solid var(--color-gray-200);
}

.card__title {
  font-size: var(--font-size-xl);
  font-weight: var(--font-weight-bold);
}

.card__body {
  padding: var(--space-lg);
}

.card__footer {
  padding: var(--space-md) var(--space-lg);
  border-top: 1px solid var(--color-gray-200);
}

.card--elevated {
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.card--outlined {
  border: 1px solid var(--color-gray-200);
}
```

```typescript
import styles from "./Card.module.css";

interface ICard {
  intent?: "elevated" | "outlined";
  title?: string;
  children: React.ReactNode;
  footer?: React.ReactNode;
}

function Card({ intent = "elevated", title, children, footer }: ICard) {
  const cardClasses = [styles.card, styles[`card--${intent}`]].filter(Boolean).join(" ");

  return (
    <div className={cardClasses}>
      {title && (
        <div className={styles.card__header}>
          <h3 className={styles.card__title}>{title}</h3>
        </div>
      )}
      <div className={styles.card__body}>{children}</div>
      {footer && <div className={styles.card__footer}>{footer}</div>}
    </div>
  );
}
```

#### Input Component

```css
/* Input.module.css */
.input {
  width: 100%;
}

.input__label {
  display: block;
  margin-bottom: var(--space-xs);
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
}

.input__field {
  width: 100%;
  padding: var(--space-sm) var(--space-md);
  font-size: var(--font-size-base);
  border: 1px solid var(--color-gray-200);
  border-radius: var(--border-radius-md);
  transition: border-color var(--transition-base);
}

.input__field:focus {
  outline: none;
  border-color: var(--color-primary);
}

.input__helper {
  margin-top: var(--space-xs);
  font-size: var(--font-size-xs);
  color: var(--color-secondary);
}

.input__error {
  margin-top: var(--space-xs);
  font-size: var(--font-size-xs);
  color: var(--color-error);
}

.input--error .input__field {
  border-color: var(--color-error);
}

.input--disabled .input__field {
  opacity: 0.5;
  cursor: not-allowed;
  background-color: var(--color-gray-100);
}
```

## CSS Variable Usage Patterns

### In Component Styles

```css
.button {
  padding: var(--space-md) var(--space-lg);
  font-size: var(--font-size-base);
  border-radius: var(--border-radius-md);
  transition: all var(--transition-base);
  background-color: var(--color-primary, #18181b);
}
```

### Dynamic Variables (Component Level)

```css
.component {
  --component-bg: var(--color-white);
  --component-color: var(--color-primary);

  background-color: var(--component-bg);
  color: var(--component-color);
}

.component--dark {
  --component-bg: var(--color-primary);
  --component-color: var(--color-white);
}
```

### Inline Styles with CSS Variables

```typescript
<div
  className={styles.component}
  style={
    {
      "--dynamic-color": color,
      "--dynamic-size": `${size}px`,
    } as React.CSSProperties
  }
/>
```

```css
.component {
  background-color: var(--dynamic-color);
  width: var(--dynamic-size);
}
```

## Class Merger Utility

```typescript
// utils/cx.ts
export function cx(...classes: (string | boolean | undefined | null)[]): string {
  return classes.filter(Boolean).join(" ");
}

// Usage
import { cx } from "../../utils/cx";

const classes = cx(styles.button, styles[`button--${intent}`], disabled && styles["button--disabled"]);
```

## Key Rules

### TypeScript

- Use `INTENT` instead of `VARIANT`
- Type as `IntentType` not `VariantType`
- Use `as const` for constants
- Extend HTML attributes when applicable
- No `any`, always strict typing

### CSS Architecture

- **Settings**: Only CSS variables, no styles
- **Generic**: Resets and normalize only
- **Elements**: Base HTML element styles (no classes)
- **Components**: Component styles with BEM in CSS Modules
- Always use CSS variables for all design tokens

### BEM Best Practices

- Block: Component name (`.button`, `.card`, `.input`)
- Element: Block + `__` + element (`.button__icon`, `.card__header`)
- Modifier: Block + `--` + modifier (`.button--primary`, `.card--elevated`)
- No nesting beyond one level (`.block__element`, not `.block__element__subelement`)
- Modifiers can apply to blocks or elements

### CSS Variables Best Practices

- Define all design tokens in `variables.css`
- Use semantic naming: `--color-primary` not `--blue-500`
- Group by category (colors, spacing, typography)
- Use fallback values when needed
- Create component-level variables for dynamic values

### React Patterns

- Named exports only: `export { Component }`
- Barrel exports in `index.ts`
- Optional chaining: `onClick?.()`
- Functional state updates: `setState(prev => ...)`
- Use `useId()` for unique IDs

## Complex Component Example (Form with BEM)

```typescript
import { useState } from "react";
import { INTENT } from "./Form.constants";
import styles from "./Form.module.css";

interface IForm extends React.FormHTMLAttributes<HTMLFormElement> {
  intent?: IntentType;
  title?: string;
}

function Form({ intent = INTENT.DEFAULT, title, children, className = "", ...props }: IForm) {
  const formClasses = cx(styles.form, styles[`form--${intent}`], className);

  return (
    <form className={formClasses} {...props}>
      {title && (
        <div className={styles.form__header}>
          <h2 className={styles.form__title}>{title}</h2>
        </div>
      )}
      <div className={styles.form__body}>{children}</div>
    </form>
  );
}
```

```css
/* Form.module.css */
.form {
  display: flex;
  flex-direction: column;
  gap: var(--space-lg);
}

.form__header {
  padding-bottom: var(--space-md);
  border-bottom: 1px solid var(--color-gray-200);
}

.form__title {
  font-size: var(--font-size-2xl);
  font-weight: var(--font-weight-bold);
  color: var(--color-primary);
}

.form__body {
  display: flex;
  flex-direction: column;
  gap: var(--space-md);
}

.form--compact .form__body {
  gap: var(--space-sm);
}

.form--inline {
  flex-direction: row;
  align-items: center;
}

.form--inline .form__body {
  flex-direction: row;
  flex: 1;
}
```

## Import Order

```typescript
import { useState } from "react";
import { Button, Input } from "../../components";
import { INTENT, SIZE } from "./Component.constants";
import { cx } from "../../utils/cx";
import type { IntentType } from "./types";
import styles from "./Component.module.css";
```

## Best Practices

- Use `intent` for semantic component variations (primary, secondary, success, error)
- Use BEM for components with internal structure
- Define all design tokens as CSS variables
- Keep ITCSS layers separate and organized
- One CSS Module per component
- No magic numbers in styles
- Semantic BEM class names
- Single responsibility per component
- No `console.log` in production
- Prefer CSS transitions/animations over JS

## CSS Organization in Components (BEM)

```css
/* Component.module.css */

/* 1. Component variables (if needed) */
.component {
  --local-spacing: var(--space-md);
}

/* 2. Block */
.component {
}

/* 3. Elements */
.component__header {
}
.component__body {
}
.component__footer {
}

/* 4. Modifiers - Intents */
.component--primary {
}
.component--secondary {
}
.component--success {
}
.component--error {
}

/* 5. Modifiers - States */
.component--active {
}
.component--disabled {
}
.component--loading {
}

/* 6. Modifiers - Sizes */
.component--small {
}
.component--large {
}

/* 7. Element modifiers (if needed) */
.component__header--sticky {
}

/* 8. Pseudo-classes */
.component:hover {
}
.component:focus {
}
.component__element:hover {
}
```
